{% extends 'base.html' %}

{% block content %}
<h2>Соглашения</h2>
<a href="{{ url_for('agreement.create_agreement') }}">Создать новое соглашение</a>
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Книга</th>
            <th>Клиент</th>
            <th>Дата выдачи</th>
            <th>Дата возврата</th>
            <th>Действия</th>
        </tr>
    </thead>
    <tbody>
        {% for agreement in agreements %}
        <tr>
            <td>{{ agreement.agreement_id }}</td>
            <td>{{ agreement.book.book_name }}</td>
            <td>{{ agreement.client.library_card_number }}</td>
            <td>{{ agreement.issuance_date }}</td>
            <td>{{ agreement.return_date or 'Не возвращено' }}</td>
            <td>
                {% if not agreement.return_date %}
                <form action="{{ url_for('agreement.close_agreement', agreement_id=agreement.agreement_id) }}" method="POST" style="display:inline;">
                    <button type="submit">Закрыть</button>
                </form>
                {% endif %}
                <form action="{{ url_for('agreement.delete_agreement', agreement_id=agreement.agreement_id) }}" method="POST" style="display:inline;">
                    <button type="submit">Удалить</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
